# Diagrama de Flujo de Concurrencia

## Flujo Completo de una SimulaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USUARIO                                  â”‚
â”‚                            â†“                                     â”‚
â”‚                   Presiona "CREAR"                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     startSimulation()                            â”‚
â”‚                   (game/game.go:113)                            â”‚
â”‚                                                                  â”‚
â”‚  1. Lock Mutex                                                  â”‚
â”‚  2. Resetear estado                                             â”‚
â”‚  3. Obtener inclinaciÃ³n actual                                  â”‚
â”‚  4. Unlock Mutex                                                â”‚
â”‚  5. Lanzar 3 goroutines:                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“                    â†“                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Goroutineâ”‚         â”‚ Goroutineâ”‚         â”‚ Goroutineâ”‚
    â”‚    1     â”‚         â”‚    2     â”‚         â”‚    3     â”‚
    â”‚ (TFLuna) â”‚         â”‚  (MPU)   â”‚         â”‚  (IMX)   â”‚
    â”‚   ğŸ”´     â”‚         â”‚   ğŸ”µ     â”‚         â”‚   ğŸŸ¢     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                    â†“                    â†“
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SendPOSTRequest() [EN PARALELO]                     â”‚
â”‚              (simulation/workers.go:64)                          â”‚
â”‚                                                                  â”‚
â”‚  Por cada goroutine:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. Lock Mutex                                            â”‚  â”‚
â”‚  â”‚ 2. Crear PacketState inicial                            â”‚  â”‚
â”‚  â”‚    - Status: SendingToAPI                               â”‚  â”‚
â”‚  â”‚    - PosiciÃ³n: (80, startY)                             â”‚  â”‚
â”‚  â”‚    - Target: Python API (250, 200)                      â”‚  â”‚
â”‚  â”‚    - Color: segÃºn sensor                                â”‚  â”‚
â”‚  â”‚ 3. Agregar a visState.Packets[packetID]                 â”‚  â”‚
â”‚  â”‚ 4. Unlock Mutex                                         â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ 5. Serializar datos a JSON                              â”‚  â”‚
â”‚  â”‚ 6. Sleep (500-1000ms) - Simular latencia               â”‚  â”‚
â”‚  â”‚ 7. HTTP POST a localhost:8000/[sensor]/sensor          â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ 8. Lock Mutex                                           â”‚  â”‚
â”‚  â”‚ 9. Actualizar estado segÃºn resultado:                   â”‚  â”‚
â”‚  â”‚    - Ã‰xito  â†’ Status: ArrivedAtAPI                     â”‚  â”‚
â”‚  â”‚    - Error  â†’ Status: Error                            â”‚  â”‚
â”‚  â”‚ 10. Unlock Mutex                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ HTTP Server API â”‚
                    â”‚  (localhost)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GAME LOOP (60 FPS)                          â”‚
â”‚                   (game/game.go:Update/Draw)                     â”‚
â”‚                                                                  â”‚
â”‚  Cada frame (16.67ms):                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Update():                                                â”‚  â”‚
â”‚  â”‚   1. handleInput() - Leer teclado/mouse                â”‚  â”‚
â”‚  â”‚   2. updatePacketFSM() - Actualizar estados            â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ updatePacketFSM():                                      â”‚  â”‚
â”‚  â”‚   1. Lock Mutex                                         â”‚  â”‚
â”‚  â”‚   2. Decrementar timers de animaciÃ³n                   â”‚  â”‚
â”‚  â”‚   3. Para cada paquete:                                â”‚  â”‚
â”‚  â”‚      - Mover hacia objetivo (3 px/frame)              â”‚  â”‚
â”‚  â”‚      - Si llegÃ³ â†’ handlePacketArrival()               â”‚  â”‚
â”‚  â”‚   4. Unlock Mutex                                       â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ Draw():                                                 â”‚  â”‚
â”‚  â”‚   1. Dibujar fondo                                     â”‚  â”‚
â”‚  â”‚   2. Dibujar trÃ­pode animado                           â”‚  â”‚
â”‚  â”‚   3. Dibujar iconos (con animaciÃ³n si timer > 0)      â”‚  â”‚
â”‚  â”‚   4. Lock Mutex                                         â”‚  â”‚
â”‚  â”‚   5. Dibujar paquetes en movimiento                    â”‚  â”‚
â”‚  â”‚   6. Unlock Mutex                                       â”‚  â”‚
â”‚  â”‚   7. Dibujar dashboard con resultados                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                handlePacketArrival() [FSM]                       â”‚
â”‚                   (game/game.go:195)                             â”‚
â”‚                                                                  â”‚
â”‚  Switch por estado actual:                                      â”‚
â”‚                                                                  â”‚
â”‚  ArrivedAtAPI:                                                  â”‚
â”‚    â†’ PythonAPITimer = 30                                        â”‚
â”‚    â†’ Status = ProcessingAtAPI                                   â”‚
â”‚                                                                  â”‚
â”‚  ProcessingAtAPI:                                               â”‚
â”‚    â†’ ProcessingTimer--                                          â”‚
â”‚    â†’ Si timer == 0:                                            â”‚
â”‚       â†’ Status = SendingToRabbit                               â”‚
â”‚       â†’ Target = RabbitMQ (400, 200)                           â”‚
â”‚                                                                  â”‚
â”‚  SendingToRabbit:                                               â”‚
â”‚    â†’ Si llegÃ³:                                                 â”‚
â”‚       â†’ RabbitMQTimer = 30                                     â”‚
â”‚       â†’ Status = ProcessingAtRabbit                            â”‚
â”‚                                                                  â”‚
â”‚  ProcessingAtRabbit:                                            â”‚
â”‚    â†’ ProcessingTimer--                                          â”‚
â”‚    â†’ Si timer == 0:                                            â”‚
â”‚       â†’ Status = SendingToWebsocket                            â”‚
â”‚       â†’ Target = WebSocket API (550, 200)                      â”‚
â”‚                                                                  â”‚
â”‚  SendingToWebsocket:                                            â”‚
â”‚    â†’ Si llegÃ³:                                                 â”‚
â”‚       â†’ WebsocketAPITimer = 30                                 â”‚
â”‚       â†’ Status = ProcessingAtWebsocket                         â”‚
â”‚                                                                  â”‚
â”‚  ProcessingAtWebsocket:                                         â”‚
â”‚    â†’ ProcessingTimer--                                          â”‚
â”‚    â†’ Si timer == 0:                                            â”‚
â”‚       â†’ Status = SendingToFrontend                             â”‚
â”‚       â†’ Target = Monitor (620, 180)                            â”‚
â”‚                                                                  â”‚
â”‚  SendingToFrontend:                                             â”‚
â”‚    â†’ Si llegÃ³:                                                 â”‚
â”‚       â†’ Status = Done                                          â”‚
â”‚       â†’ Active = false                                         â”‚
â”‚       â†’ updateDashboard(packet) - Mostrar datos              â”‚
â”‚                                                                  â”‚
â”‚  Done:                                                          â”‚
â”‚    â†’ Paquete completado, ya no se dibuja                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Timeline de EjecuciÃ³n

```
Tiempo (ms)    Evento
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0              Usuario presiona CREAR
1              startSimulation() ejecuta
2              3 goroutines lanzan (TFLuna, MPU, IMX)
3-5            Goroutines crean PacketState (con Mutex)
6-506          Goroutines duermen (simulan latencia de red)
507-1007       HTTP POST ejecuta en paralelo
1008           Primera respuesta llega (Goroutine 1)
               â†’ Lock, actualiza a ArrivedAtAPI, Unlock
1015           Segunda respuesta (Goroutine 2)
1020           Tercera respuesta (Goroutine 3)
1021+          Game loop actualiza FSM y dibuja paquetes moviÃ©ndose

Frame 1        Paquetes aparecen en trÃ­pode
Frame 10       Paquetes viajan hacia Python API
Frame 20       Paquetes llegan a Python API
Frame 21-50    Iconos Python animados (30 frames)
Frame 51       Paquetes salen hacia RabbitMQ
Frame 70       Paquetes llegan a RabbitMQ
Frame 71-100   Iconos RabbitMQ animados
Frame 101      Paquetes salen hacia WebSocket
Frame 120      Paquetes llegan a WebSocket
Frame 121-150  Iconos WebSocket animados
Frame 151      Paquetes salen hacia Monitor
Frame 170      Paquetes llegan a Monitor
Frame 171      Dashboard actualizado con datos
               â†’ Distancia: 2.54 m
               â†’ Nitidez: 5.26
               â†’ Roll: 8.5Â°
Frame 172      SimulaciÃ³n completa, botÃ³n reactiva
```

## SincronizaciÃ³n con Mutex

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MUTEX (sync.Mutex)                            â”‚
â”‚                   Protege: VisualState                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WRITERS         â”‚                      â”‚  READERS         â”‚
â”‚  (Goroutines)    â”‚                      â”‚  (Game Loop)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Lock()        â”‚                      â”‚ 1. Lock()        â”‚
â”‚ 2. Write state   â”‚                      â”‚ 2. Read state    â”‚
â”‚ 3. Unlock()      â”‚                      â”‚ 3. Unlock()      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                                           â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Estado Seguro  â”‚
                    â”‚  Sin Races      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Race Condition Prevention

### Sin Mutex (âŒ INCORRECTO):
```
Tiempo  Goroutine 1         Goroutine 2         Game Loop
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
T1      Read Packets[1]
T2                          Read Packets[1]
T3      Modify Status
T4                          Modify Status       
T5                                              Read Packets[1]
T6      Write Packets[1]                        â† Valor nuevo
T7                          Write Packets[1]    â† Sobrescribe!
                                                â† Valor perdido
```

### Con Mutex (âœ… CORRECTO):
```
Tiempo  Goroutine 1         Goroutine 2         Game Loop
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
T1      Lock() âœ“
T2      Read Packets[1]     Lock() â³ espera
T3      Modify Status
T4      Write Packets[1]                        Lock() â³ espera
T5      Unlock() âœ“
T6                          Lock() âœ“            â³ espera
T7                          Read Packets[1]
T8                          Modify Status
T9                          Write Packets[1]
T10                         Unlock() âœ“
T11                                             Lock() âœ“
T12                                             Read Packets[1]
T13                                             â† Valor correcto
T14                                             Unlock() âœ“
```

## ComunicaciÃ³n entre Componentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Goroutine 1    â”‚â”€â”€â”
â”‚    (TFLuna)      â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                      â”œâ”€â”€â†’ [Mutex] â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                â”‚  VisualState     â”‚
â”‚   Goroutine 2    â”‚â”€â”€â”¤                â”‚  (Shared State)  â”‚
â”‚     (MPU)        â”‚  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                         â†“
                      â”‚                [Mutex] â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                            â”‚   Game Loop      â”‚
â”‚   Goroutine 3    â”‚â”€â”€â”˜                            â”‚   (Renderer)     â”‚
â”‚    (IMX477)      â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â†“
                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                    â”‚     Screen       â”‚
                                                    â”‚   (Usuario ve)   â”‚
                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ventajas de Esta Arquitectura

1. **Performance**: 3x mÃ¡s rÃ¡pido que secuencial
2. **Thread-Safe**: Mutex previene race conditions
3. **Visual**: Usuario ve concurrencia en tiempo real
4. **Modular**: FÃ¡cil agregar mÃ¡s sensores/goroutines
5. **Responsive**: UI nunca se bloquea
6. **Realista**: Simula hardware real con latencia

## Resumen de Goroutines

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  GOROUTINES ACTIVAS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Main Goroutine:     1 (Game Loop - Ebitengine)         â”‚
â”‚ Worker Goroutines:  3 (TFLuna + MPU + IMX477)          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ TOTAL:             4 goroutines por simulaciÃ³n          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ciclo de Vida de una Goroutine Worker

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  go SendPOST()  â”‚ â† Lanzada por startSimulation()
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Running â”‚ â† Goroutine activa
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Sleep  â”‚ â† Simula latencia (500-1000ms)
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚HTTP POSTâ”‚ â† I/O bloqueante
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Update  â”‚ â† Actualiza estado con Mutex
    â”‚  State  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Exit   â”‚ â† Goroutine termina, liberada por GC
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
